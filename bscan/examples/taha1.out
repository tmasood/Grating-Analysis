There must be sandwiches above and below the grating. 
Super Matrix Leanding Dimension: 1560
Grating Upper Left Hand corner is ( 60, 30 )
Lower Layers  Left Hand corner is ( 180, 150 )
       Lower Right Hand corner is ( 1560, 1560 )
 lambda =  1.31 

 layer   index      thickness
------------------------------------
  0   1.000000   1.000000   0.000000  AirRegion
  1   1.700000   1.700000   0.100000  NitrideLayer
  2   3.198700   3.198700   0.050000  PSpacer(Grating
  3   3.268900   3.250000   0.003300  pTransitionGRIN
  4   3.250000   3.240000   0.003300  pTransition
  5   3.240000   3.231000   0.003300  pTransition
  6   3.231000   3.231000   0.110000  InnerPCladding
  7   3.231000   3.290000   0.033000  PSrin
  8   3.290000   3.330000   0.033000  PSrin
  9   3.330000   3.372800   0.033000  PSrin
 10   3.485000   3.485000   0.005000  QW
 11   3.372800   3.372800   0.010000  Barrier
 12   3.485000   3.485000   0.005000  QW
 13   3.372800   3.372800   0.010000  Barrier
 14   3.485000   3.485000   0.005000  QW
 15   3.372800   3.372800   0.010000  Barrier
 16   3.485000   3.485000   0.005000  QW
 17   3.372800   3.372800   0.010000  Barrier
 18   3.485000   3.485000   0.005000  QW
 19   3.372800   3.330000   0.033000  NSrin
 20   3.330000   3.291000   0.033000  NSrin
 21   3.291000   3.231000   0.033000  NSrin
 22   3.231000   3.231000   0.110000  InnerNCladding
 23   3.231000   3.240000   0.003300  nTransition
 24   3.240000   3.250000   0.003300  nTransition
 25   3.250000   3.268900   0.003300  nTransition
 26   3.198700   3.198700   0.000000  NSubstrate
------------------------------------
Refractive index of tooth:   3.198700
 Refractive index of fill:   1.700000
------------------------------------
 0    0.15000   AirRegion
 1    0.05000   NitrideLayer
 2    0.00000   PSpacer(Grating
 3   -0.00330   pTransitionGRIN
 4   -0.00660   pTransition
 5   -0.00990   pTransition
 6   -0.11990   InnerPCladding
 7   -0.15290   PSrin
 8   -0.18590   PSrin
 9   -0.21890   PSrin
10   -0.22390   QW
11   -0.23390   Barrier
12   -0.23890   QW
13   -0.24890   Barrier
14   -0.25390   QW
15   -0.26390   Barrier
16   -0.26890   QW
17   -0.27890   Barrier
18   -0.28390   QW
19   -0.31690   NSrin
20   -0.34990   NSrin
21   -0.38290   NSrin
22   -0.49290   InnerNCladding
23   -0.49620   nTransition
24   -0.49950   nTransition
25   -0.50280   nTransition
*************************************************************************
*            Results for Mode With Grating Unloaded
***********************************w(z)=0********************************
      z                         RCOND          INFO
(9.261000e-04,3.219000e+00)	2.120966e-04	0
(2.070766e-05,3.221842e+00)	2.303220e-06	0
(3.608592e-09,3.221869e+00)	2.547444e-10	0
(2.058786e-17,3.221869e+00)	2.231592e-18	0
     0
  8.716e-03  3.160e-17 
  3.418e-02  8.784e-17 
  6.146e-02  3.072e-16 
  6.363e-02  6.839e-17 
  6.580e-02  1.047e-16 
  6.796e-02  4.497e-17 
  1.393e-01  4.684e-17 
  1.604e-01  2.203e-16 
  1.803e-01  1.016e-17 
  1.977e-01  2.160e-16 
  2.000e-01  1.644e-16 
  2.041e-01 -1.161e-17 
  2.059e-01  1.795e-16 
  2.091e-01  6.112e-18 
  2.105e-01 -4.011e-17 
  2.128e-01  4.608e-17 
  2.138e-01 -1.139e-16 
  2.152e-01 -8.489e-17 
  2.156e-01  0.000e+00 
  2.153e-01 -1.388e-16 
  2.104e-01 -4.478e-17 
  2.024e-01 -7.989e-17 
  1.703e-01 -4.344e-17 
  1.693e-01 -1.404e-16 
  1.683e-01 -2.070e-16 
  1.673e-01 -6.396e-17 
  1.673e-01 -6.127e-17 
     0
  0.000e+00  0.000e+00 
 -9.431e-02 -2.473e-16 
 -1.373e-01 -3.546e-16 
 -1.370e-01 -2.054e-16 
 -1.368e-01 -2.034e-16 
 -1.367e-01 -1.802e-16 
 -1.335e-01 -1.317e-16 
 -1.321e-01 -1.917e-16 
 -1.201e-01 -3.508e-17 
 -9.889e-02 -5.556e-17 
 -9.048e-02 -1.404e-16 
 -8.083e-02 -8.904e-17 
 -7.215e-02 -7.728e-17 
 -6.224e-02  4.090e-17 
 -5.336e-02 -3.655e-17 
 -4.326e-02 -7.319e-17 
 -3.423e-02  2.943e-18 
 -2.399e-02  1.076e-16 
 -1.487e-02 -7.388e-17 
  1.914e-02  7.033e-17 
  4.305e-02 -8.296e-17 
  5.777e-02 -1.145e-16 
  6.357e-02 -8.628e-18 
  6.373e-02 -4.993e-17 
  6.404e-02 -1.728e-16 
  6.452e-02 -6.698e-17 
  0.000e+00  0.000e+00 

Converged in 4 Iterations.
 zguess   = ( 9.2610000000e-04 ,    3.2190000000 ) 
 zroot    = ( 2.058786080682267e-17 ,    3.221868689451169 ) 

 Layer Confinement Factors 
Gamma( 0) =      1.1107e-04 AirRegion
Gamma( 1) =      1.7466e-03 NitrideLayer
Gamma( 2) =      4.8688e-03 PSpacer(Grating
Gamma( 3) =      5.5449e-04 pTransitionGRIN
Gamma( 4) =      5.9361e-04 pTransition
Gamma( 5) =      6.3401e-04 pTransition
Gamma( 6) =      5.2903e-02 InnerPCladding
Gamma( 7) =      3.1886e-02 PSrin
Gamma( 8) =      4.1253e-02 PSrin
Gamma( 9) =      5.0824e-02 PSrin
Gamma(10) =      8.4914e-03 QW
Gamma(11) =      1.7536e-02 Barrier
Gamma(12) =      9.0258e-03 QW
Gamma(13) =      1.8504e-02 Barrier
Gamma(14) =      9.4565e-03 QW
Gamma(15) =      1.9252e-02 Barrier
Gamma(16) =      9.7723e-03 QW
Gamma(17) =      1.9762e-02 Barrier
Gamma(18) =      9.9651e-03 QW
Gamma(19) =      6.6072e-02 NSrin
Gamma(20) =      6.4392e-02 NSrin
Gamma(21) =      6.0483e-02 NSrin
Gamma(22) =      1.6492e-01 InnerNCladding
Gamma(23) =      4.0875e-03 nTransition
Gamma(24) =      4.0391e-03 nTransition
Gamma(25) =      3.9907e-03 nTransition
Gamma(26) =      3.2488e-01 NSubstrate

phi ( 0) =  2.60833e-02, 9.45684e-17   phip( 0) =  0.00000e+00, 0.00000e+00 
phi ( 1) =  1.02282e-01, 2.62850e-16   phip( 1) = -2.82221e-01,-7.39883e-16 
phi ( 2) =  1.83910e-01, 9.19225e-16   phip( 2) = -4.10949e-01,-1.06109e-15 
phi ( 3) =  1.90408e-01, 2.04644e-16   phip( 3) = -4.10045e-01,-6.14605e-16 
phi ( 4) =  1.96893e-01, 3.13455e-16   phip( 4) = -4.09487e-01,-6.08708e-16 
phi ( 5) =  2.03372e-01, 1.34574e-16   phip( 5) = -4.09116e-01,-5.39178e-16 
phi ( 6) =  4.16964e-01, 1.40179e-16   phip( 6) = -3.99460e-01,-3.94198e-16 
phi ( 7) =  4.79867e-01, 6.59201e-16   phip( 7) = -3.95278e-01,-5.73557e-16 
phi ( 8) =  5.39651e-01, 3.03893e-17   phip( 8) = -3.59448e-01,-1.04980e-16 
phi ( 9) =  5.91594e-01, 6.46236e-16   phip( 9) = -2.95928e-01,-1.66268e-16 
phi (10) =  5.98390e-01, 4.91928e-16   phip(10) = -2.70745e-01,-4.20024e-16 
phi (11) =  6.10685e-01,-3.47461e-17   phip(11) = -2.41879e-01,-2.66449e-16 
phi (12) =  6.16175e-01, 5.37282e-16   phip(12) = -2.15915e-01,-2.31263e-16 
phi (13) =  6.25822e-01, 1.82894e-17   phip(13) = -1.86263e-01, 1.22391e-16 
phi (14) =  6.29970e-01,-1.20015e-16   phip(14) = -1.59686e-01,-1.09368e-16 
phi (15) =  6.36905e-01, 1.37891e-16   phip(15) = -1.29440e-01,-2.19018e-16 
phi (16) =  6.39686e-01,-3.40943e-16   phip(16) = -1.02424e-01, 8.80735e-18 
phi (17) =  6.43864e-01,-2.54021e-16   phip(17) = -7.17795e-02, 3.21909e-16 
phi (18) =  6.45259e-01, 0.00000e+00   phip(18) = -4.44978e-02,-2.21091e-16 
phi (19) =  6.44244e-01,-4.15225e-16   phip(19) =  5.72889e-02, 2.10463e-16 
phi (20) =  6.29495e-01,-1.34000e-16   phip(20) =  1.28810e-01,-2.48253e-16 
phi (21) =  6.05598e-01,-2.39052e-16   phip(21) =  1.72860e-01,-3.42654e-16 
phi (22) =  5.09688e-01,-1.29994e-16   phip(22) =  1.90219e-01,-2.58183e-17 
phi (23) =  5.06673e-01,-4.20063e-16   phip(23) =  1.90693e-01,-1.49417e-16 
phi (24) =  5.03648e-01,-6.19555e-16   phip(24) =  1.91630e-01,-5.17021e-16 
phi (25) =  5.00603e-01,-1.91391e-16   phip(25) =  1.93077e-01,-2.00431e-16 
***************************************************************
***   Itteration 0 
***************************************************************
Panel Sizes 15 15 15 
Grating Depth 0.05 
Calculated Duty Cycle 0.500000 
Tooth Size (A region)  0.1015 
Fill Size  (B region)  0.1015 
Grating Period = 0.203
Boundary Matrix N*N, N = 120

Completed g1 and h1...
Completed g2 and h2...
 Minimizing the matrix condition factor RCOND ...
           Zguess                RCOND
(9.261000e-04,3.219000e+00)	1.086572e-03	0
(4.408918e-04,3.221766e+00)	2.058349e-04	0
(4.766880e-05,3.222530e+00)	1.190244e-05	0
(1.961992e-07,3.222560e+00)	4.592657e-08	0
(-2.537772e-12,3.222560e+00)	6.862632e-13	0
 Alpha = 1.217198e-11 
 Beta*Clambda/2Pi = 0.499374
