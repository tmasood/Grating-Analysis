
\chapter{INTRODUCTION} \label{ch:introduction}

\section{Periodic Corrugations}

Integrated optics devices such as couplers, filters, DFB and DBR
lasers contain periodic corrugations. For these devices the
propagating wavelength is of the same order as the spatial period of
the corrugation. It is therefore necessary to apply field theory to
determine characteristic modes.

\subsection{Maxwell's Equations}
The four equations can be presented in differential or integral
form. They are listed below in both forms.

\begin{equation}
\begin{array}{c c}
\nabla \times \mathbf{E} = \frac{-\partial{\mathbf{B}}}{\partial{t}} &
\qquad \oint \mathbf{E} \cdot dl = \frac{-\partial}{\partial{t}}\int
\mathbf{B} \cdot d \mathbf{S} \\
\end{array}
\label{curlE}
\end{equation}

\begin{equation}
\begin{array}{c c}
\nabla \times \mathbf{H} = \mathbf{J} + 
\frac{-\partial{\mathbf{D}}}{\partial{t}} &
\qquad \oint \mathbf{H} \cdot dl = \int \mathbf{J} \cdot d \mathbf{S}
+ \frac{\partial}{\partial{t}}\int_{area} \mathbf{D} \cdot d \mathbf{S}
\end{array}
\label{curlH}
\end{equation}

\begin{equation}
\begin{array}{c c}
\nabla \cdot \mathbf{B} = 0 &
\qquad \int \mathbf{B} \cdot d\mathbf{S} = 0 \\
\nabla \cdot \mathbf{D} = \rho &
\qquad \int \mathbf{D} \cdot d\mathbf{S} = Q_{enclosed}
\end{array}
\end{equation}

$\mathbf{E}$ and $\mathbf{H}$ are electric and magnetic field
amplitudes, whereas $\mathbf{D}$ and $\mathbf{B}$ are electric and
magnetic flux densities respectively. $\mathbf{E}$, $\mathbf{H}$,
$\mathbf{D}$ and $\mathbf{D}$ are continuous functions of space and
time with continuous derivatives.

Assuming simple linear relationship between electric vectors.

\begin{equation}
\mathbf{D} = \varepsilon \mathbf{E}
\label{Ddef}
\end{equation}

Similarly relationship between $\mathbf{H}$ and $\mathbf{B}$ is given by

\begin{equation}
\mathbf{B} = \mu \mathbf{H}
\label{magflux}
\end{equation}

The displacement vector D satisfies the equation below in the absense
of electric charges.

\begin{equation}
\mathbf{\nabla \cdot D} = 0
\label{defD0}
\end{equation}

The flow of electromagnetic power is space is described by the Poynting vector

\begin{equation}
\mathbf{S} = \mathbf{E} \times \mathbf{H}
\end{equation}

The power $\mathbf{P}$ flowing through an area A with an outward-directed normal unit vector n is given by

\begin{equation}
\mathbf{P} = \int_{\mathbf{A}} \mathbf{S} \cdot \mathbf{n}\, d{A}
\end{equation}

The time averaged poynting vector is given by

\begin{equation}
\mathbf{\bar{S}} = \frac{1}{2}[\mathbf{E} \times \mathbf{H^*}]
\end{equation}

\subsection{Wave Equation}

Substituting (\ref{magflux}) into (\ref{curlE}) and taking the curl on
both sides.

\begin{equation}
\nabla \times (\nabla \times \mathbf{E}) = 
-\mu \frac{\partial{}}{\partial{t}}(\mathbf{\nabla \times H})
\label{curlcurlE}
\end{equation}

Where $\mu$ is constant. Substituting (\ref{curlH}) and (\ref{Ddef})
into (\ref{curlcurlE}).

\begin{equation}
\nabla \times (\nabla \times \mathbf{E}) + \varepsilon \mu
\frac{\partial^2{E}}{\partial{t^2}}
\label{curlcurlE2}
\end{equation}

Equation (\ref{curlcurlE2}) holds even when $\varepsilon$ varies.

\begin{equation}
\nabla \times (\nabla \times \mathbf{E}) =
\nabla (\nabla \cdot \mathbf{E}) - \nabla^2 \mathbf{E}
\label{vident}
\end{equation}

Using relationship (\ref{vident}), we can write (\ref{curlcurlE2}) as

\begin{equation}
\nabla (\nabla \cdot \mathbf{E}) - \nabla^2 \mathbf{E} + \varepsilon \mu
\frac{\partial^2{E}}{\partial{t^2}} = 0
\label{divergradE}
\end{equation}

Using (\ref{Ddef}) and product rule (\ref{divproductrule})

\begin{equation}
\nabla \cdot \left(\frac{1}{\varepsilon}\mathbf{D}\right)=
 \left(\nabla \frac{1}{\varepsilon}\right)
\cdot D + \frac{1}{\varepsilon}(\nabla \cdot D)
\label{divproductrule}
\end{equation}

And in the absence of electric charges (\ref{defD0}), we can write equation
(\ref{divergradE}) as

\begin{equation}
\nabla^2 \mathbf{E} + \nabla \left[ \mathbf{E} \cdot \frac{\nabla \varepsilon}
{\varepsilon}\right]
 = \varepsilon \mu \frac{\partial^2 \mathbf{E}}{\partial t^2}
\label{earlywaveeq}
\end{equation}

When $\varepsilon$ is constant then

\begin{equation}
\nabla^2 \mathbf{E}
 = \varepsilon \mu \frac{\partial^2 \mathbf{E}}{\partial t^2}
\label{waveeq}
\end{equation}

The integral form of the curl equations are derived from the
differential forms by application of Stokes Theorem. This
theorem relates the curl o a vector function, A, into a line
integral of the function.

\begin{equation}
\int_{area} ( \nabla \times \mathbf{A} ) \cdot d \mathbf{S} = 
\oint_{loop} \mathbf{A} \cdot dl
\end{equation}

where $d \mathbf{S}$ and $d\mathbf{l}$ are unit vectors oriented normal
to the surface. For the divergence equations, Gauss' divergence theorem

Wave equation in terms of electric field amplitude reduced to its
homogenous form is given by

\begin{equation}
\nabla^2 \mathbf{E} - \mu \epsilon \frac{\partial^2 
  \mathbf{E}}{\partial t^2} = 0
\end{equation}

The wave equation in terms of magnetic field amplitude is 

\begin{equation}
\nabla^2 \mathbf{H} - \mu \epsilon \frac{\partial^2 
  \mathbf{H}}{\partial t^2} = 0
\end{equation}

\subsection{Floquet-Bloch Waves} The electromagnetic waves traveling
along periodic structures is described by Floquet's theorem,

\begin{equation}
\mathbf{\Psi(x,y,z)} = e^{\gamma z} \mathbf{\Phi(x,y,z)} = 0
\label{defD0}
\end{equation}

where $\Phi$ is a $z$-periodic vector valued function and $\gamma$
is the propagation constant. The real part of $\gamma$ represents the
attenuation and the imaginary part the phase shift of the fundamental
mode in one period.

The comtemporary approaches to find propagation constant rely on
finding the roots of the determinant with Muller's or the Newton's
method. Another approach solves they eigenvalue problem by relying on
finding the roots of a Dirichlet-to-Neumann operator and linearization
of the matrix problem.

A typical waveguide geometry is shown in Fig. \ref{gratwg}. The
wavegujide geometry consists of an infinite substrate region
($\Omega_0$), several finite stratified layers, a grating layer
sandwitched between the stratified layers, and an infinite superstrate
region ($\Omega_J$). The structure is also infinite and homogeneous in
the $y$-direction. The layers are assumed to be linear, isotropic, and
non-dispersive, therefore the magnetic permeability $\mu$ and electric
permettivity $\epsilon$ are constant scalars in each layer. A finite
conductivity of the material is accounted by letting $\epsilon$ be
complex.

\setlength{\unitlength}{0.25in}
\begin{picture}(20,10)(-2.5,0)
\put(0,0){\line(1,0){15}}
\put(0,2.5){\line(1,0){15}}
\put(0,5){\line(1,0){15}}
\put(5,-0.4){\line(0,1){5.8}}
\put(7.5,-0.4){\line(0,1){5.8}}
\put(9.5,0){\line(0,1){1.0}}
\put(9.5,2.5){\line(0,1){1.0}}
\put(10.5,2.5){\line(0,1){1.0}}
\label{gratwg}
\end{picture}

For this geometry the fundamental modes of the guide are either
transverse electric,

\begin{equation}
\mathbf{E}(x,y,z) = u(x,z)\mathbf{e}_y
\end{equation}

or transverse magnetic,

\begin{equation}
\mathbf{H}(x,y,z) = u(x,z)\mathbf{h}_y
\end{equation}

where the wavefunction $u$ satisfies the Helmholtz equation

\begin{equation}
\triangle u + \mu \epsilon \omega^2 u = 0
\end{equation}

in each layer.

The condition, 

\begin{equation}
u^+ = u^- \textrm{and} \quad \frac{1}{\mu^+}\frac{\partial{u^+}}{\partial{n}} =
\frac{1}{\mu^-}\frac{\partial{u^-}}{\partial{n}} \quad \textrm{for TE modes},
\end{equation}

\begin{equation}
u^+ = u^- \textrm{and} \quad \frac{1}{\epsilon^+}\frac{\partial{u^+}}{\partial{n}} =
\frac{1}{\epsilon^-}\frac{\partial{u^-}}{\partial{n}} \quad \textrm{for TM modes},
\end{equation}

holds at the interface of two different layers for TE and TM modes
respectively. The superscript refers to the left or right side of the
interface. In practical applications, the optical waveguide material
is non-magnetic with magnetic permeability equal to that of free
space.

According to Floquet's theorem, the fundamental transverse mode must
satisfy the periodic condition

\begin{equation}
u(x,z + \Lambda) = e^{\gamma \Lambda} u(x,z),
\end{equation}

where the propagation constant $\gamma$ is (in general)
complex. Because of this condition, it suffices to solve the Helmholtz
equation in one fundamental period $\Lambda$ of the grating. The
boundary conditions on the upper and the lower boundary of the period,
$\Gamma_2$ and $\Gamma_0$, repectively are

\begin{equation}
u|_{\Gamma_2} = e^{\gamma \Lambda} u|_{\Gamma_0} \textrm{and}
\frac{\partial u}{\partial n} |_{\Gamma_2} = -e^{\gamma \Lambda}
 \frac{\partial u}{\partial n} |_{\Gamma_0}
\end{equation}

The negative sign in the above equation is due to the normals at
$\Gamma_2$ and $\Gamma_0$ pointing in opposite directions.

In the numerical treatment of Helmholz equation, the transverse
structure is divided into three regions. The interior region
$\Omega_{int}$ contains the grating layer and two semi-infinite
exterior regions, $\Omega_+$ and $\Omega_-$ include the stratified
layers above and below the grating layer repectively (see
Fig. \ref{gratwg2}). The left interface of the domain is denoted by
$\Gamma_3^-$ and $\Gamma_3^+$ is the right interface.

\setlength{\unitlength}{0.25in}
\begin{picture}(20,10)(-2.5,0) \put(0,0){\line(1,0){15}}
\put(0,2.5){\line(1,0){15}} \put(0,5){\line(1,0){15}}
\put(5,-0.4){\line(0,1){5.8}} \put(7.5,-0.4){\line(0,1){5.8}}
\put(9.5,0){\line(0,1){1.0}} \put(9.5,2.5){\line(0,1){1.0}}
\put(10.5,2.5){\line(0,1){1.0}}
\label{gratwg2}
\end{picture}

The solution in the exterior regions is expanded in terms of space
harmonics in the form

\begin{equation}
u(x,z) = \sum_{n \in \mathbf{Z}} f_n^- e^{(ik_{xn}^J(x -
x^+))} e^{k_{zn}z}, x \geq x^+
\label{spharm1}
\end{equation}

\begin{equation}
u(x,z) = \sum_{n \in \mathbf{Z}} f_n^+ e^{(ik_{xn}^0(x^- -
x))} e^{k_{zn}z}, x \geq x^-
\label{spharm2}
\end{equation}

where $i = sqrt{-1}, j \in \lbrace 0,J \rbrace$ and

\begin{equation} k_{zn} = \frac{2 n \pi i}{\Lambda} + \gamma,
\end{equation}

\begin{equation} k_{xn}^j = \pm \sqrt{k_{zn}^2 + \mu_j \epsilon_j
\omega^2}
\end{equation}

The $f_n^\pm$ are the fourier coefficients of the solution on
$\Gamma_3^\pm$

\begin{equation}
f_n^\pm = \frac{1}{\Lambda}\int_0 u(x^\pm,z) e^{-k_{zn} z} dz
\label{fcoeff}
\end{equation}

The solution in the exterior regions can be obtained from
\ref{fcoeff}, \ref{spharm1}, \ref{spharm2}, if $\gamma$ and $u$ on the
interface $\Gamma_3$ are given. The mapping from $u|_{\Gamma_3}$ to
$\frac{\partial u}{\partial n} |_{\Gamma_3}$ is the
Dirichlet-to-Neumann (DtN) map for the exterior region, which we write
as

\begin{equation}
\frac{\partial u}{\partial n} |_{\Gamma_3} \coloneqq T_{ext}(\gamma)
u|_{\Gamma_3} = \left \{ \begin{array}{ll} \sum_{n \in \mathbf{Z}} i
k_{xn}^J f_n^+ e^{k_{zn}z} \quad \textrm{on} \; \Gamma_3^+ \\
\sum_{n \in \mathbf{Z}} ik_{xn}^0 f_n^- e^{-k_{zn}z} \quad
\textrm{on}\; \Gamma_3^- \end{array}\right .
\end{equation}

The problem is reduced to finding the values of $\gamma$ for which the
Helmholtz equation in $\Omega_{int}$ has non-trivial solutions.

\begin{equation}
\begin{array}{ll}
\triangle u + \mu \epsilon \omega^2 u = 0, \quad \textrm{in}
\Omega_{int} \\
u|_{\Gamma_2} = e^{\gamma \Lambda} u|_{\Gamma_0} \\
\frac{\partial u}{\partial n} |_{\Gamma_2} = -e^{\gamma \Lambda}
 \frac{\partial u}{\partial n} |_{\Gamma_0} \\
\frac{\partial u}{\partial n} |_{\Gamma_3} =  T_{ext}(\gamma) u|_{\Gamma_3}
\end{array}
\end{equation} 

 The eigen value problem is then solved in the interior region
numerically using the Boundary Element Method and matched with the
analytical solution in the exterior regions.

Helmholtz equation is reduced to a linear system after
discretization. Some coefficients of this linear system depend on the
propagation constant $\gamma$ non-linearly. The task is to find
$\gamma$ such that the matrix is non-singular, which is a non-linear
eigen value problem.

Previous methods differ in the solution of the interior problem; for
instance \ref{} describes expansion in spatial harmonics, and \ref{}
describes use of boundary element method.

The approach followed here is an equivalent formulation based on DtN
map which leads to much smaller matrix problems. The Helmholtz
equation in $\Omega_{int}$ with given Dirichlet boundary conditions on
$\Gamma_3$

\begin{equation}
\begin{array}{ll}
\triangle u + \mu \epsilon \omega^2 u = 0, \quad \textrm{in}
\Omega_{int} \\
u|_{\Gamma_2} = e^{\gamma \Lambda} u|_{\Gamma_0} \\
\frac{\partial u}{\partial n} |_{\Gamma_2} = -e^{\gamma \Lambda}
 \frac{\partial u}{\partial n} |_{\Gamma_0} \\
u|_{\Gamma_3} = f
\end{array}
\label{DtNf}
\end{equation} 

has a unique solution $u$.

The interior DtN map is given by
\begin{equation}
  T_{int}(\gamma) f = \frac{\partial u}{\partial n} |_{\Gamma_3}
\end{equation} 

where $u$ is the solution of \ref{DtNf}.

The propagation constants are values of $\gamma$ that make the operator
\begin{equation}
T(\gamma) = T_{int}(\gamma) - T_{ext}(\gamma)
\end{equation} 

singular. That is, there is a Dirichlet condition f $\neq$ 0 on
$\Gamma_3$ such that
\begin{equation}
T(\gamma) f = 0
\label{eqTf}
\end{equation}

Since f is in the nullspace of $T(\gamma)$, the normal derivatives
approached from both sides of the interface match, and therefore $u$
is a solution on the infinite strip and $\gamma$ is a propagation
constant.

Problem \ref{eqTf} is attractive for numerical calculation because the
unknown f is defined only on the interface $\Gamma_3$. Thus fewer
degrees of freedom in the discretization are required than the problem
in $\Omega_{int}$.

\subsubsection{Discretization of the DtN map}
To discretize operator equation \ref{eqTf} a Galerkin approach is employed. To this end, the approximate solution is written as a linear combination of harmonics up to a given degree $p$.